%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%           Table of contents           %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\definecolor{doc}{HTML}{6e000d}
\contentsmargin{0cm}
\titlecontents{chapter}[3.7pc]
{\addvspace{30pt}
	\begin{tikzpicture}[remember picture, overlay]
		\draw[fill=doc!90,draw=doc!90] (-7, -0.1) rectangle (-0.12, 0.5);
        \draw[fill=white!60,draw=white!60] (-0.6, -0.15) rectangle (-0.10, 0.55);
		\pgftext[left,x=-3.5cm,y=0.2cm]{\color{white}\Large\sc\bfseries Chapter\ \color{doc}\Large\sc\bfseries \thecontentslabel};
	\end{tikzpicture}\color{doc!90} $\quad \blacktriangleright \;$ \large\sc\bfseries}
{}
{}
{\;\titlerule\;\large\sc\bfseries Page \thecontentspage
	\begin{tikzpicture}[remember picture, overlay]
		\draw[fill=doc!90,draw=doc!90] (2pt,0) rectangle (4,0.1pt);
	\end{tikzpicture}}
 
\titlecontents{section}[3.7pc]
{\addvspace{2pt}}
{\contentslabel[\thecontentslabel]{2pc}}
{}
{\hfill\small \thecontentspage}
[]

\titlecontents{subsection}[6.5pc]
{\addvspace{1.75pt}}
{\contentslabel[\thecontentslabel]{2.7pc}}
{}
{\hfill\small \thecontentspage}
[]

\makeatletter
\renewcommand{\tableofcontents}{
	\chapter*{
	  \vspace*{-30\p@}
	  \begin{tikzpicture}[remember picture, overlay]%
		  \pgftext[right,x=15cm,y=0.2cm]{\color{doc!90} \Huge\sc\bfseries \contentsname};%
		  \draw[fill=doc!90,draw=doc!90] (13,-.75) rectangle (20,1);%
		  \clip (13,-.75) rectangle (20,1);
		  \pgftext[right,x=15cm,y=0.2cm]{\color{white} \Huge\sc\bfseries \contentsname};%
	  \end{tikzpicture}}
	\@starttoc{toc}}
\makeatother